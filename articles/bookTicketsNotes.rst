====
Notes for `TicketsController.BookTickets </controllers/TicketsController.rst#booktickets>`_
====

* You must remember that for “Certificate of birth” and “Russian passport” types of documents the patronymic must consist of at least two letters (dash is forbidden). Other types of documents may have no patronymic. Format of "name" constituents (surname, name, patronymic): each constituent may have from minimum one up to maximum thirty characters unless otherwise stipulated (as is the case with “Certificate of birth” and “Russian passport”). For Russian internal documents (that is “Russian passport”, “Certificate of birth”, “Military card”, “Sailor passport”) only Cyrillic characters must be used to specify "name" (dash is allowed). For “Foreign passport” and “Alien document” Roman characters can also be used to specify "name". A document number may consist of ciphers, Roman and Cyrillic characters (dashes and whitespaces are forbidden). There is a length limit: “Russian passport” and “Certificate of birth” – from 6 to 14 characters; “Sailor passport” and “Military card” – from 1 to 17 characters, “Foreign passport” and “Alien document” – from 6 to 22 characters. In all input line data including passenger information it is forbidden to use whitespaces and the Cyrillic characters “Ё” and “Ъ”. However, no error is to occur if they are input because “Ё”/ “Ъ” is automatically substituted with “Е”/“Ь”, and this substitution is invisible for passengers. This substitution is visible only in the content of the form printed out in the RR (Russian Railways) terminal; the Web service output will have passengers information (and other line data) identical to those input. In the same way each embedded whitespaces will be substituted with a dash before feeding the request into the “Экспресс-3” (railway tickets ACS); whitespaces at the end of a line will be deleted.
* There are checks for the number (proportion) of certain passenger categories in an order. Any order must have at least one adult. Any child's ticket must relate to an adult's ticket. Only one free ticket without seat for an under-five child can be issued for each one adult. For example, if a mother travels with two under-five child, she has to register three tickets and pay for two seats (one under-five child has a free ticket without seat, the other one has a child fare ticket). Both child's ticket (free ticket and child fare ticket) relate to the adult's ticket. At the moment, maximum number of tickets in an order is four. There can be no more than two children without seat in one order.
* There are also checks for the correspondence of passengers' number to additional parameters. Number of seats in the seats range (if specified) must equal or exceed the number of “paying” passengers. Otherwise, error will be displayed. Likewise, error will be displayed if the specified number of a seat does not correspond to the entered requirement for the tier. In other words, if an odd seat is specified, this can be only lower seat (next to the window in case of sitting tickets) and vice versa.
* There are limits for the number of lower seats in one order. If an adult travels with an under-ten child, they can have two lower seats. In other cases the rule is: no more than half of total number of seats in the order can be lower seats. In case of odd total number of seats the fractional number is rounded up (for example, two lower seats out of three total seats). Besides, the sum of upper and lower seats must not exceed the total number of seats in the order.
* Special remarks must be made for buying tickets in compartments that are divided in “female” and “male” ones. In case of such discrimination the requirement for specifying the gender of passengers is mandatory. Gender is checked based on some formal evidence (based on surname/name/patronymic analysis). However, there is exception to the rule – if the whole compartment is bought in one order. In other words, if the number of passengers traveling together is “4” for “compartment” type car and the requirement “in one compartment” is specified. In this case passengers of different genders can travel in one compartment. To enter input parameters correctly you must specify a gender (allowed for this compartment) though there will be no further checking.
* Some trains have luxury “Grand” type cars (soft cars) with information sign “price for 2 seats”. Therefore, in such compartments it is only possible to buy all two seats, that is the whole compartment. That is why a two-ticket price is specified. Besides, for such cars there is no discount fare for children– all seats are sold for full adult fare.
* If the train crosses borders of some foreign states (independent of direction – in or out), all passengers must travel (and register) using foreign or alien passports. Russian internal documents for such itineraries are invalid. These states include (apart from non-FSU states) the following former Soviet Union states: Moldova, Lithuania, Latvia, Estonia, Uzbekistan, and Azerbaijan.
* For discount category “child from 5 to 10” any documents can be used except for internal passport (since it is issued at an older age); alien passport can also be used. The same is true for discount category “child under 5 without seat”, that is for infants.
* Unlike full fare applicable to adult passengers, in case of child's discount tickets there is a limit for the number of seats registered in such a way – only one seat can be bought per one benefit holder. An adult can register in his/her name up to 4 seats in one order – there is no limit.
* Travel documents can be issued no earlier than 45 days before the train departure date (for cross-border direction no earlier than 60 days).
